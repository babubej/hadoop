<assembly
	xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2 http://maven.apache.org/xsd/assembly-1.1.2.xsd">
	<id>core</id>
	<formats>
		<format>tar.gz</format>
	</formats>
	<includeBaseDirectory>true</includeBaseDirectory>
	<baseDirectory>core_${parsedVersion.majorVersion}_${parsedVersion.minorVersion}_${parsedVersion.incrementalVersion}/</baseDirectory>
  <dependencySets>
    <dependencySet>
      <useProjectArtifact>false</useProjectArtifact>
      <useTransitiveDependencies>true</useTransitiveDependencies>
      <unpack>false</unpack>
      <scope>runtime</scope>
      <fileMode>0644</fileMode>
      <directoryMode>0755</directoryMode>
      <outputDirectory>/workflow/lib/</outputDirectory>
      <includes>
        <!--    
        <include>org.apache.hbase:hbase</include>
        <include>org.apache.hbase:hbase-client</include>
        <include>org.apache.hbase:hbase-protocol</include>
        <include>org.apache.hbase:hbase-hadoop2-compat</include>
        <include>org.apache.hbase:hbase-server</include>
        <include>org.apache.hbase:hbase-common</include>
        <include>org.apache.zookeeper:zookeeper</include>
        <include>org.apache.hive:hive-hbase-handler</include>
        <include>com.google.guava:guava</include>
        <include>com.github.stephenc.high-scale-lib:high-scale-lib</include>
        -->
        <include>org.apache.pig:piggybank</include>

      </includes>
      <outputFileNameMapping>${artifact.artifactId}.${artifact.extension}</outputFileNameMapping>

    </dependencySet> 
  </dependencySets>
	<fileSets>
		<fileSet>
			<directory>${project.basedir}/src/main/oozie/workflow</directory>
			<outputDirectory>/workflow/</outputDirectory>
			<includes>
        <include>*.xml</include>
      </includes>
			<excludes>
				<exclude>*.properties</exclude>
			</excludes>
		</fileSet>
		<fileSet>
			<directory>${project.basedir}/src/main/conf/${env}</directory>
			<outputDirectory>/workflow/conf/</outputDirectory>
		</fileSet>
		<fileSet>
			<directory>${project.basedir}/src/main/pig</directory>
			<outputDirectory>/workflow/pig/</outputDirectory>
		</fileSet>
		<fileSet>
			<directory>${project.basedir}/src/main/hql</directory>
			<outputDirectory>/workflow/hql/</outputDirectory>
		</fileSet>
		<fileSet>
			<directory>${project.basedir}/src/main/scripts</directory>
			<outputDirectory>/workflow/scripts/</outputDirectory>
		</fileSet>
		<fileSet>
			<directory>${project.build.directory}</directory>
			<outputDirectory>/workflow/lib/</outputDirectory>
			<includes>
				<include>*.jar</include>
			</includes>
		</fileSet>
		<fileSet>
			<directory>${project.basedir}/src/main/oozie/coordinator</directory>
			<outputDirectory>/coordinator/</outputDirectory>
			<includes>
        <include>*.xml</include>
      </includes>
			<excludes>
				<exclude>*.properties</exclude>
			</excludes>
		</fileSet>
		<fileSet>
			<directory>${project.basedir}/src/main/oozie/bundle</directory>
			<outputDirectory>/bundle/</outputDirectory>
			<includes>
        <include>*.xml</include>
      </includes>
			<excludes>
				<exclude>*.properties</exclude>
			</excludes>
		</fileSet>
	</fileSets>
	<!-- Filter the .properties files to set namenode and jobtracker urls -->
  <files>
		<file>
			<source>${project.basedir}/src/main/oozie/bundle/bundle_core.properties</source>
			<outputDirectory>/bundle/</outputDirectory>
			<filtered>true</filtered>
		</file>
	</files>
</assembly>
